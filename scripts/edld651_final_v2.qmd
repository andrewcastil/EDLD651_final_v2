---
title: "EDLD Final Project v2"
author: "Frances Pinkham, Eunji Kong, Elyse Calhoun, Yitong Jiang"
format: html
editor: visual
embed-resources: true
---

```{r}
#| eval: true
#| echo: false
library(tidyverse)
library(here)
library(rio)
library(modelsummary)
```

```{r}
schooling <- import(here("data","Schooling.csv"))
```

```{r}
schoolingsub <- schooling %>%
  select(rownames,ed76, daded, momed, wage76, iqscore, age76, nearc2, nearc4)

```

```{r}
schoolingsub1 <- schoolingsub |> 
  mutate(near_college = ifelse(nearc2 == "yes" & nearc4 =="yes", "near_colleges", 
                               ifelse(nearc2 == "yes" & nearc4 =="no","near_cc", 
                                      ifelse(nearc2 == "no" & nearc4 =="yes","near_4yr", "not_near_college")))) 
```

```{r}
schoolingsub1 <- schoolingsub1 %>%
  pivot_longer(
    cols = c(daded,momed),
    names_to = "parent",
    values_to = "education")
```

Demographics

```{r}
datasummary_skim(schoolingsub1 |> 
                   pivot_wider (names_from = parent,
                                values_from = education) |> 
                   select(-rownames),
                 histogram = FALSE)
```

Research question 1: What is the relationship between parent education and participant's education?

```{r}
schoolingsub1 |> 
  ggplot(aes(education, ed76, color = parent)) +
  geom_smooth(method = lm, se = FALSE) + theme_minimal()

```

Research question 2: What is the relationship between parent education and participant's wage?

```{r}
schoolingsub1 |> 
  ggplot(aes(education, wage76, color = parent)) +
  geom_smooth(method = lm, se = FALSE) + theme_minimal()
```

Research question 3: Is there a difference in wage depending on whether you lived near a collge?

```{r}
schoolingsub1 %>%   
  group_by(near_college) |> 
  summarize(avg_wage = mean(wage76, na.rm = TRUE)/100) |> 
DT::datatable()
```
